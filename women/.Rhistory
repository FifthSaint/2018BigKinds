install.packages("DescTools")
library("DescTools")
detach("package:DescTools", unload=TRUE)
libarary(DescTools)
library(DescTools)
install.packages("RDCOMClient")
install.package("kablkdjfl")
install.packages("RDCOMClient", repos = "http://www.omegahat.net/R")
XLGetRange(header=TRUE)
library(RDCOMClient)
XLGetRange(header=TRUE)
XLGetRange(header=TRUE)
library(readxl)
Excel_stats <- read_excel("C:/Temp/Excel stats.xlsx")
View(Excel_stats)
data <- Excel_stats[1:2]
data
View(data)
View(data)
load("~/2018 언론진흥재단 뉴스빅데이터 활용 교육/(1주차) 백영민 강의자료 (2) (3)/.RData")
library(tidyverse)
ggplot(iris, aes(x=Sepal.Width, y=Sepal.Length)) + geom_point()
install.packages(DescTools)
install.packages("DescTools")
install.packages("RDCOMClient", repos = "http://www.omegahat.net/R")
XLGetRange(header=TRUE)
library(RDCOMClient)
XLGetRange(header=TRUE)
library(DescTools)
XLGetRange(header=TRUE)
mydata<-XLGetRange(header=TRUE)
mydata
summary(mydata)
XLView(d.pizza)
library("DescTools", lib.loc="~/R/win-library/3.5")
options(fmt.abs=structure(list(digits=0, big.mark=","), class="fmt"))
Desc(d.pizza$temperature)
Desc(d.pizza$driver)
?XLView
?RDCOMClient
??RDCOMClient
?XLGetRange
install.packages("DescTools")
# 사용을 위해 라이브러리 등록을 해줍니다
library(DescTools)
?XLView
install.packages("RDCOClient")
install.packages("RDCOMClient")
install.packages("RDCOMClient", repos = "http://www.omegahat.net/R")
library(RDCOMClient)
XLGetRange(header=TRUE)
XLGetRange(header=TRUE)
XLGetRange(header=TRUE)
XLGetRange(header=TRUE)
XLGetRange()
XLGetRange()
# 사용을 위해 라이브러리 등록을 해줍니다
library(DescTools)
library(RDCOMClient)
XLGetRange(header=TRUE)
?XLGetRange
XLGetRange(header=TRUE)
# 사용을 위해 라이브러리 등록을 해줍니다
library(DescTools)
library(RDCOMClient)
XLGetRange(header=TRUE)
XLGetRange(header=TRUE)
mydata <- XLGetRange(header=TRUE)
XLView(d.pizza)
?XLView
View(mydata)
Desc(d.pizza$temperature)
Desc(d.pizza$driver)
Desc(temperature ~ delivery_min, d.pizza)
# 숫자 변수와 문자 변수를 결합해 분석해 볼까요
Desc(delivery_min ~ driver, d.pizza)
# 숫자 변수와 문자 변수를 결합해 분석해 볼까요
Desc(delivery_min ~ area, d.pizza)
# 숫자 변수와 문자 변수를 결합해 분석해 볼까요
Desc(delivery_min ~ area, d.pizza)
# 문자 변수끼리 결합하면 어떤 결과가 나올까요?
Desc(area ~ driver, d.pizza)
# 문자 변수끼리 결합하면 어떤 결과가 나올까요?
Desc(area ~ driver, d.pizza)
install.packages("DescTools")
# 사용을 위해 라이브러리 등록을 해줍니다
library(DescTools)
# 사용을 위해 라이브러리 등록을 해줍니다
library(DescTools)
install.packages("DescTools")
# 사용을 위해 라이브러리 등록을 해줍니다
library(DescTools)
install.packages("RDCOMClient")
install.packages("RDCOMClient", repos = "http://www.omegahat.net/R")
library(RDCOMClient)
XLGetRange(header=TRUE)
XLGetRange(header=TRUE)
mydata <- XLGetRange(header=TRUE)
View(mydata)
XLView(d.pizza)
Desc(d.pizza$temperature)
Desc(d.pizza$driver)
Desc(temperature ~ delivery_min, d.pizza)
# 숫자 변수와 문자 변수를 결합해 분석해 볼까요
# 배달 시간과 지역의 관계를 한번 살펴 봅니다
Desc(delivery_min ~ area, d.pizza)
# 문자 변수끼리 결합하면 어떤 결과가 나올까요?
Desc(area ~ driver, d.pizza)
install.packages("rvest")
install.packages("dplyr")
url <- "http://www.hani.co.kr/arti/science/home01.html"
read_html(url)
library(rvest)
library(dplyr)
read_html(url)
html <- read_html(url)
html %>%
html_nodes("#contents-section > div.section-animal > div.animal-top > div.animal-top-article > h4 > a")
html %>%
html_nodes("#contents-section > div.section-animal > div.animal-top > div.animal-top-article > h4 > a")
html %>%
html_nodes("#contents-section > div.section-animal > div.animal-top > div.animal-top-article > h4 > a")
html %>%
html_nodes("#contents-section > div.section-animal > div.animal-top > div.animal-top-article > h4 > a") %>%
html_text()
url <- "http://www.hani.co.kr/arti/science/technology/868357.html"
html <- read_html(url)
html %>%
html_nodes("#a-left-scroll-in > div.article-text > div > div.text") %>%
html_text()
text <- html %>%
html_nodes("#a-left-scroll-in > div.article-text > div > div.text") %>%
html_text()
text
headline <- html %>%
html_nodes("#article_view_headline > h4 > span") %>%
html_text()
text <- html %>%
html_nodes("#a-left-scroll-in > div.article-text > div > div.text") %>%
html_text()
result <- data.frame( 제목=headline,
본문=text)
View(result)
install.packages("shiny")
library(shiny)
runExample("01_hello")
runExample("01_hello")
# Define UI for app that draws a histogram ----
ui <- fluidPage(
# App title ----
titlePanel("Hello Shiny!"),
# Sidebar layout with input and output definitions ----
sidebarLayout(
# Sidebar panel for inputs ----
sidebarPanel(
# Input: Slider for the number of bins ----
sliderInput(inputId = "bins",
label = "Number of bins:",
min = 1,
max = 50,
value = 30)
),
# Main panel for displaying outputs ----
mainPanel(
# Output: Histogram ----
plotOutput(outputId = "distPlot")
)
)
)
# Histogram of the Old Faithful Geyser Data ----
# with requested number of bins
# This expression that generates a histogram is wrapped in a call
# to renderPlot to indicate that:
#
# 1. It is "reactive" and therefore should be automatically
#    re-executed when inputs (input$bins) change
# 2. Its output type is a plot
output$distPlot <- renderPlot({
x    <- faithful$waiting
bins <- seq(min(x), max(x), length.out = input$bins + 1)
hist(x, breaks = bins, col = "#75AADB", border = "white",
xlab = "Waiting time to next eruption (in mins)",
main = "Histogram of waiting times")
})
# Define server logic required to draw a histogram ----
server <- function(input, output) {
# Histogram of the Old Faithful Geyser Data ----
# with requested number of bins
# This expression that generates a histogram is wrapped in a call
# to renderPlot to indicate that:
#
# 1. It is "reactive" and therefore should be automatically
#    re-executed when inputs (input$bins) change
# 2. Its output type is a plot
output$distPlot <- renderPlot({
x    <- faithful$waiting
bins <- seq(min(x), max(x), length.out = input$bins + 1)
hist(x, breaks = bins, col = "#75AADB", border = "white",
xlab = "Waiting time to next eruption (in mins)",
main = "Histogram of waiting times")
})
}
shinyApp(ui, server)
install.packages("googleVis")
library(googleVis)
M1 <- gvisMotionChart(Fruits, idvar="Fruit", timevar="Year")
plot(M1)
M1 <- gvisMotionChart(Fruits, idvar="Fruit", timevar="Year")
plot(M1)
#현재의 디렉토리주소 알아보기
getwd()
#디렌토리 주소 재설정
setwd("C:/Users/hannews/Documents/GitHub/2018BigKinds/women")
#폴더 안의 파일들 확인하기
list.files()
library(readxl)
# 여러개의 엑셀 파일 읽기
temp = list.files(pattern="*.xlsx")
myfiles = lapply(temp, read_excel)
#데이터 합치기
data <- Reduce(rbind, myfiles)
library(dplyr)
udata <- data[((data$"분석제외 여부" != "중복") & (data$"분석제외 여부" !="중복, 예외"))|is.na(data$"분석제외 여부"),]
# 연도별로 데이터 나누기
year <- c(1990:2018)
for (val in year)
{
nam <- paste("data", val, sep = "")
assign(nam, subset(udata, grepl(paste0("^",val), 일자)))
}
library(tm)
library(KoNLP)
## 사전 선택 택1
# useSejongDic()
useNIADic()
library(stringr)
### extWord
# 텍스트에서 상위 단어 추출하는 함수
extWord <- function(data, year) {
contents <- data$'본문'
# head(contents)
#영문표현삭제
newcontents <- str_replace_all(contents, "[[:lower:]]", "")
#제어문자 삭제
newcontents <- str_replace_all(newcontents, "[[:cntrl:]]", "")
#특수기호 삭제
newcontents <- str_replace_all(newcontents, "[[:punct:]]", "")
#숫자 = 삭제
newcontents <- str_replace_all(newcontents, "[[:digit:]]", "")
#괄호삭제
newcontents <- str_replace_all(newcontents, "\\(", "")
newcontents <- str_replace_all(newcontents, "\\)", "")
#따옴표 삭제
newcontents <- str_replace_all(newcontents, "'", "")
newcontents <- str_replace_all(newcontents, "'", "")
noun <- extractNoun(newcontents)
##불용어처리
txt_data <- gsub("//d+","",noun)
txt_data <- gsub("[[:cntrl:]]","",txt_data)
txt_data <- gsub("[[:punct:]]","",txt_data)
#이녀석이 숫자를 삭제해줍니다.
txt_data <- gsub("[[:digit:]]","",txt_data)
txt_data <- gsub("[[:lower:]]","",txt_data)
txt_data <- gsub("[[:upper:]]","",txt_data)
txt_data <- gsub("[A-z]","",txt_data)
txt_data <- gsub("'","",txt_data)
txt_data <- gsub("'","",txt_data)
txt_data <- gsub("‘","",txt_data)
txt_data <- gsub("’","",txt_data)
# head(txt_data)
myCorpus <- Corpus(VectorSource(txt_data))
myCorpus <- tm_map(myCorpus, removePunctuation)
myCorpus <- tm_map(myCorpus, removeNumbers)
myCorpus <- tm_map(myCorpus, tolower)
myCorpus <- tm_map(myCorpus, stripWhitespace)
WordList <- sapply(myCorpus, extractNoun, USE.NAMES=FALSE)
vectordata <- unlist(WordList)
vectordata <- Filter(function(x){nchar(x)>1}, vectordata)
# preview<- sort(table(vectordata), decreasing=TRUE,100)
# View(preview)
#빈도추출
wordcount <- table(vectordata)
# write.csv(wordcount,file="freq.csv")
#상위빈도로 정렬해서 result2로 명명
#result2 <- sort(wordcount, decreasing=TRUE)
# View(result2)
#누적빈도 알아보기
#cumsum.word.freq <-cumsum(result2)
#cumsum.word.freq[1:50]
#전체합이1이되는비율알아보기
#prop.word.freq <-cumsum.word.freq/cumsum.word.freq[length(cumsum.word.freq)]
#prop.word.freq[1:100]
#여성의 경우 무의미한 단어가 많이 검출되는 경향. 상위빈도 50단어 저장
result <- head(sort(wordcount, decreasing=TRUE), n=50)
#데이터프레임으로 변환
df.result <-data.frame(result)
#연도 추가
df.result$year <-year
#순위 추가
#df.result$rank <-rank(df.result$Freq)
return(df.result)
} # extWord 함수 정의 끝
words2015 <-extWord(data2015, 2015)
words2016 <-extWord(data2016, 2016)
getwd()
write.table(words2015, file = "women2015.csv", row.names=FALSE, sep=",")
